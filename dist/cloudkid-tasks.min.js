!function(){var t=function(t,s,i){this.initialize(t,s,i)},s=t.prototype;t.TASK_ABOUT_TO_START="onItemAboutToLoad",t.TASK_STARTING="onItemLoading",t.TASK_DONE="onItemLoaded",s.task=null,s.data=null,s.type=null,s.initialize=function(t,s,i){this.type=t,this.task=s,this.data=i},namespace("cloudkid").TaskEvent=t}(),function(){var t=function(t,s){this.initialize(t,s)},s=t.prototype;s.id=null,s.callback=null,s._isDestroyed=!1,s.initialize=function(t,s){this.id=t,this.callback=s},s.done=function(t,s){this.callback&&this.callback(t,this,s)},s.start=function(){Debug.assert(!1,"Base implementation of Task cannot be called")},s.cancel=function(){return!0},s.toString=function(){return"[Task ID ("+this.id+")]"},s.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this.callback=null,this.id=null)},namespace("cloudkid").Task=t}(),function(){var t=cloudkid.Task,s=function(t,s,i,e){this.initialize(t,s,i,e)},i=s.prototype=new t;i.Task_initialize=i.initialize,i.Task_destroy=i.destroy,i.serviceCall=null,i.args=null,i.initialize=function(t,s,i,e){if(this.Task_initialize(t,i),this.serviceCall=s,this.args=[],e){var n=Array.prototype.slice.call(arguments);this.args=n.slice(3)}},i.start=function(t){this.serviceCall.apply(null,[t].concat(this.args))},i.toString=function(){return"[FunctionTask ID ("+this.id+")]"},i.destroy=function(){this._isDestroyed||(this.Task_destroy(),this.serviceCall=null,this.args=null)},namespace("cloudkid").FunctionTask=s}(),function(t){var s=cloudkid.MediaLoader,i=cloudkid.Task,e=cloudkid.LoaderQueueItem,n=function(t,s,i,e,n,a){this.initialize(t,s,i,e,n,a)},a=n.prototype=new i;a.Task_initialize=a.initialize,a.Task_destroy=a.destroy,a.url=null,a.data=null,a.priority=null,a.updateCallback=null,a.initialize=function(s,i,n,a,r,l){this.url=i,this.updateCallback=a,this.priority=r===t?e.PRIORITY_NORMAL:r,this.data=l,this.Task_initialize(s,n)},a.start=function(t){s.instance.load(this.url,t,this.updateCallback,this.priority,this.data)},a.cancel=function(){return s.instance.cancel(this.url)},a.toString=function(){return"[LoadTask ID ("+this.id+"), URL ("+this.url+")]"},a.destroy=function(){this._isDestroyed||(this.Task_destroy(),this.updateCallback=null,this.url=null,this.data=null)},namespace("cloudkid").LoadTask=n}(),function(){var t=cloudkid.TaskEvent,s=function(t){this.initialize(t)},i=s.prototype;i.addEventListener=null,i.removeEventListener=null,i.removeAllEventListeners=null,i.dispatchEvent=null,i.hasEventListener=null,i._listeners=null,createjs.EventDispatcher&&createjs.EventDispatcher.initialize(i),s.VERSION="1.0.0",s.ALL_TASKS_DONE="onAllTasksDone",i.tasks=null,i._currentTasks=null,i.paused=!0,i._tasksInProgress=0,i._isDestroyed=!1,s.process=function(t,i,e,n){n=n||!0,e=e||!0;var a=s.ALL_TASKS_DONE,r=new s(t);return r.addEventListener(a,function(){r.removeEventListener(a),n&&r.destroy(),null!==i&&i()}),e?r.startAll():r.startNext(),r},i.initialize=function(t){this._currentTasks=[],this.tasks=t||[]},i.addTask=function(t){this.tasks.push(t)},i.addTasks=function(t){this.removeAll(),this.tasks=t},i.removeAll=function(){this._tasksInProgress=0,this.paused=!0;var t,s;if(this._currentTasks&&this._currentTasks.length>0)for(s=0;s<this._currentTasks.length;s++)t=this._currentTasks[s],t.cancel()&&t.destroy();if(this.tasks&&this.tasks.length>0)for(s=0;s<this.tasks.length;s++)t=this.tasks[s],t.destroy();this._currentTasks.length=0,this.tasks.length=0},i.cancelTask=function(t){var s;for(s=0;s<this._currentTasks.length;++s)this._currentTasks[s].id==t&&this._currentTasks[s].cancel()&&(this._currentTasks[s].destroy(),this._currentTasks.splice(s,1),--this._tasksInProgress,--s);for(s=0;s<this.tasks.length;++s)this.tasks[s].id==t&&(this.tasks[s].destroy(),this.tasks.splice(s,1),--s)},i.startNext=function(){if(!this._isDestroyed){Debug.assert(!!this.tasks,"startNext(): There are no task for this Task Manager");for(var s;this.tasks.length>0&&!(s=this.tasks.shift()););return s?(this._currentTasks.push(s),this.paused=!1,this.dispatchEvent(new t(t.TASK_ABOUT_TO_START,s)),this.paused?null:(this.dispatchEvent(new t(t.TASK_STARTING,s)),this._tasksInProgress++,s.start(this.onTaskDone.bind(this,s)),s)):null}},i.onTaskDone=function(i,e){if(!this._isDestroyed){this._tasksInProgress--,this.dispatchEvent(new t(t.TASK_DONE,i,e)),i.done(e,this);var n=this._currentTasks.indexOf(i);n>-1&&this._currentTasks.splice(n,1),i.destroy(),0===this._tasksInProgress&&0===this.tasks.length?this.dispatchEvent(new t(s.ALL_TASKS_DONE,null)):this.paused||this.startNext()}},i.startAll=function(){Debug.assert(!!this.tasks,"startAll(): There are no task for this Task Manager");for(var t=[];;){var s=this.startNext();if(!s)break;t.push(s)}return t},i.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this.removeAll(),this._currentTasks=null,this.tasks=null)},namespace("cloudkid").TaskManager=s}(),function(){var t=cloudkid.Task,s=cloudkid.LoadTask,i=cloudkid.TaskEvent,e=cloudkid.TaskManager,n=function(t,s,i){this.initialize(t,s,i)},a=n.prototype=new t;a.Task_initialize=a.initialize,a.Task_destroy=a.destroy,a.list=null,a._manager=null,a._results=null,a.initialize=function(i,e,n){this.Task_initialize(i,n);for(var a=[],r=0;r<e.length;r++)e[r]&&(e[r]instanceof t?a.push(e[r]):e[r].id&&e[r].src&&a.push(new s(e[r].id,e[r].src,e[r].callback,e[r].updateCallback,e[r].priority,e[r].data)));this.list=a},a.start=function(t){this._results={},this._manager=new e(this.list.slice()),this._manager.addEventListener(i.TASK_DONE,this._onTaskDone.bind(this)),this._manager.addEventListener(e.ALL_TASKS_DONE,this._onAllTasksComplete.bind(this,t)),this._manager.startAll()},a._onTaskDone=function(t){this._isDestroyed||(this._results[t.task.id]=t.data)},a._onAllTasksComplete=function(t){this._isDestroyed||t(this._results)},a.cancel=function(){return this._manager.removeAll(),!0},a.toString=function(){return"[ListTask ID ("+this.id+"), tasks ("+this.list+")]"},a.destroy=function(){if(!this._isDestroyed){this.Task_destroy(),this._results=null;for(var t=0;t<this.list.length;t++)this.list[t].destroy();this._manager&&(this._manager.destroy(),this._manager=null),this.list=null}},namespace("cloudkid").ListTask=n}(),function(){var t=function(t,s,i,e,n){this.initialize(t,s,i,e,n)},s=t.prototype=new cloudkid.Task;s.Task_initialize=s.initialize,s.Task_destroy=s.destroy,s.urls=null,s.updateCallback=null,s.generateCanvas=!1,s._assetLoader=null,s.initialize=function(t,s,i,e,n){for(var a=cloudkid.MediaLoader.instance.cacheManager,r=0;r<s.length;++r)s[r]=a.prepare(s[r]);this.urls=s,this.updateCallback=e,this.generateCanvas=n||!1,this.Task_initialize(t,i)},s.start=function(t){var s=cloudkid.OS.instance.options;this._assetLoader=new PIXI.AssetLoader(this.urls,s.crossOrigin,this.generateCanvas,s.basePath),this._assetLoader.onComplete=t,this.updateCallback&&(this._assetLoader.onProgress=this.onProgress.bind(this)),this._assetLoader.load()},s.onProgress=function(){this.updateCallback()},s.cancel=function(){return this._assetLoader.onComplete=null,this._assetLoader.onProgress=null,!0},s.toString=function(){return"[PixiTask ID ("+this.id+"), URLs ("+this.urls.join(", ")+")]"},s.destroy=function(){this._isDestroyed||(this.Task_destroy(),this.updateCallback=null,this.urls=null,this._assetLoader&&(this._assetLoader.onComplete=null,this._assetLoader.onProgress=null),this._assetLoader=null)},namespace("cloudkid").PixiTask=t}();